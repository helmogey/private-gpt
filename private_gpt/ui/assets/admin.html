<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - DocuMind</title>
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="/assets/admin.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="admin-header">
        <div class="admin-header-left">
            <h1>Admin Panel</h1>
        </div>
        <div class="admin-header-right">
            <a href="/" class="back-button icon-button">
                <svg width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/></svg>
                <span>Back to Chat</span>
            </a>
            <div id="page-header-actions">
                <button id="theme-toggle-btn" class="theme-toggle" title="Toggle Theme">
                    <svg class="theme-icon" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
                </button>
                <div class="profile-dropdown-container">
                    <button id="profile-btn" class="theme-toggle" title="Profile">
                        <svg width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M12 4a4 4 0 0 1 4 4a4 4 0 0 1-4 4a4 4 0 0 1-4-4a4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4Z"/></svg>
                    </button>
                    <div id="profile-dropdown" class="profile-dropdown">
                        <div class="profile-details">
                            <strong>Welcome, <span id="profile-username">Admin</span></strong>
                            <span id="profile-role" class="user-role admin">admin</span>
                        </div>
                        <a href="/logout" class="dropdown-item"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M16 17v-3H9v-4h7V7l5 5-5 5M14 2a2 2 0 0 1 2 2v2h-2V4H5v16h9v-2h2v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9Z"/></svg>Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="admin-container">
        <div class="admin-tabs">
            <button id="user-management-tab" class="admin-tab active">User Management</button>
            <button id="doc-management-tab" class="admin-tab">Document Management</button>
        </div>

        <!-- User Management Content -->
        <div id="user-management-content" class="tab-pane active">
            <div class="admin-card">
                <h3>Create New User</h3>
                <form id="create-user-form" class="admin-form-container">
                    <div class="form-group">
                        <label for="new-username">Username</label>
                        <input type="text" id="new-username" class="textbox" placeholder="e.g., john.doe" autocomplete="off" required>
                    </div>
                    <div class="form-group">
                        <label for="new-password">Password</label>
                        <input type="password" id="new-password" class="textbox" placeholder="Enter a secure password" autocomplete="new-password" required>
                    </div>
                    <div class="form-group">
                        <label for="new-user-role">Role</label>
                        <select id="new-user-role" class="textbox">
                            <option value="user">User</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="new-user-team">Team</label>
                        <select id="new-user-team" class="textbox"></select>
                    </div>
                    <button type="submit" class="icon-button form-submit-btn">Create User</button>
                </form>
                <div id="create-user-status" class="upload-status"></div>
            </div>
            <div class="admin-card">
                <h3>Existing Users</h3>
                <ul id="user-list" class="user-list">
                    <!-- Users will be dynamically inserted here -->
                </ul>
            </div>
        </div>

        <!-- Document Management Content -->
        <div id="doc-management-content" class="tab-pane">
            <div class="admin-card">
                <h3>Document Permissions</h3>
                <p class="form-hint">Edit which teams can access each ingested document.</p>
                <div class="doc-table-container">
                    <table class="doc-table">
                        <thead>
                            <tr>
                                <th>File Name</th>
                                <th>Permitted Teams</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="doc-list">
                            <!-- Document list will be dynamically inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Permissions Modal -->
    <div id="permissions-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Permissions for <span id="modal-doc-name" style="font-weight: 700;"></span></h2>
                <button id="permissions-modal-close-btn" class="theme-toggle">&times;</button>
            </div>
            <div class="modal-body">
                <p class="form-hint" style="margin-top: 0; margin-bottom: 1rem;">Move teams between lists to grant or revoke access.</p>
                <div class="team-selector-container">
                    <div class="team-list-box">
                        <h4>Available Teams</h4>
                        <ul id="available-teams-list-modal" class="team-list"></ul>
                    </div>
                    <div class="team-list-box">
                        <h4>Assigned Teams</h4>
                        <ul id="assigned-teams-list-modal" class="team-list"></ul>
                    </div>
                </div>
                <div class="modal-actions">
                    <button id="cancel-permissions-btn" class="icon-button">Cancel</button>
                    <button id="save-permissions-btn" class="icon-button">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/assets/admin.js"></script>
</body>
</html>

